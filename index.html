<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Junge Leute · Drink Control 2025</title>
    <style>
        body { margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; color: #fff; background: url('https://i.imgur.com/2h3fD0P.jpg') center/cover fixed; min-height: 100vh; }
        .overlay { background: linear-gradient(135deg, rgba(0,0,0,0.93), rgba(20,0,40,0.88)); min-height: 100vh; padding: 15px 0; }
        .con { max-width: 960px; margin: 0 auto; background: rgba(20,20,30,0.97); border-radius: 25px; padding: 30px; box-shadow: 0 0 40px rgba(255,149,0,0.7); border: 2px solid #ff9500; }
        .logos { text-align: center; margin-bottom: 15px; }
        .logos img { height: 110px; margin: 0 25px; vertical-align: middle; }
        .jl-text { color: #ff9500; font-size: 52px; font-weight: 900; letter-spacing: 4px; text-shadow: 0 0 20px #ff9500; }
        h1 { color: #ff9500; text-align: center; font-size: 2.8em; text-shadow: 0 0 20px #ff9500; margin: 15px 0 25px; }
        select { background: #111; color: #ff9500; padding: 12px; border-radius: 12px; border: 2px solid #ff9500; font-weight: bold; }
        .lang { text-align: center; margin: 25px 0; }
        .card { background: rgba(40,40,60,0.95); padding: 25px; border-radius: 18px; margin: 20px 0; border: 1px solid #ff9500; box-shadow: 0 8px 25px rgba(255,149,0,0.3); }
        input, button { padding: 16px; margin: 10px 0; font-size: 18px; border-radius: 14px; width: 100%; border: none; }
        input { background: #222; color: white; border: 2px solid #ff9500; }
        button { background: #ff9500; color: black; font-weight: 900; cursor: pointer; transition: all .3s; }
        button:hover { background: #ffb84d; transform: scale(1.05); box-shadow: 0 0 20px #ff9500; }
        .btn-s { background: #00ff88; color: black; }
        .btn-d { background: #ff2d55; color: white; }
        .btn-w { background: #ffcc00; color: black; }
        .btn-del { background: #8B0000; padding: 8px 12px; font-size: 14px; }
        .hidden { display: none; }
        #contador { font-size: 100px; color: #00ff88; font-weight: 900; text-align: center; margin: 40px 0; text-shadow: 0 0 30px #00ff88; letter-spacing: 3px; }
        .drink { background: #222; padding: 18px; border-radius: 14px; margin: 12px 0; display: flex; justify-content: space-between; align-items: center; border-left: 6px solid #00ff88; }
        .admin-badge { background: #ff4444; padding: 6px 14px; border-radius: 20px; font-size: 13px; margin-left: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #555; }
        th { background: #ff9500; color: black; font-weight: bold; }
        .backup-status { color: #00ff88; font-size: 14px; text-align: center; margin: 10px 0; font-weight: bold; }
        footer { color: #ff9500; text-align: center; margin-top: 50px; font-size: 15px; font-weight: bold; text-shadow: 0 0 10px #ff9500; }
    </style>
</head>
<body>
    <div class="overlay">
        <div class="con">
            <div class="logos">
                <img src="https://www.muenzinghof.de/images/design/logo-schild-260@2x.png" alt="Münzinghof">
                <div class="jl-text">JL</div>
            </div>
            <h1 id="title">Junge Leute · Drink Control 2025</h1>
            
            <div class="lang">
                <select id="langSelect" onchange="changeLang()">
                    <option value="de">Deutsch</option>
                    <option value="es">Español</option>
                    <option value="en">English</option>
                </select>
            </div>

            <div class="backup-status" id="backupStatus">Backup automatisch aktiviert</div>

            <div id="login" class="card">
                <h2 id="tLogin">Anmelden</h2>
                <input type="text" id="userLogin" placeholder="Benutzername">
                <input type="password" id="passLogin" placeholder="Passwort">
                <button onclick="login()" class="btn-s" id="tEnter">Anmelden</button>
                <button onclick="showReg()" id="tNew">Neuer Benutzer</button>
            </div>

            <div id="register" class="card hidden">
                <h2 id="tReg">Benutzer erstellen</h2>
                <input type="text" id="newUser" placeholder="Dein Name">
                <input type="password" id="p1" placeholder="Passwort">
                <input type="password" id="p2" placeholder="Passwort wiederholen">
                <button onclick="reg()" class="btn-s" id="tCreate">Erstellen</button>
                <button onclick="back()" id="tCancel">Abbrechen</button>
            </div>

            <div id="panel" class="hidden">
                <h2 id="tWelcome">Willkommen, <span id="name"></span><span id="adminBadge" class="admin-badge hidden">ADMIN</span></h2>
                <div style="text-align:center">
                    <h3 id="tTotal">Deine Getränke gesamt:</h3>
                    <div id="contador">0</div>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin:40px 0">
                    <button onclick="addMode()" class="btn-s" style="font-size:26px;padding:28px" id="tAdd">+ Hinzufügen</button>
                    <button onclick="conMode()" class="btn-d" style="font-size:26px;padding:28px" id="tCon">- Verbraucht</button>
                </div>
                <button onclick="logout()" style="width:100%;padding:20px;font-size:19px" id="tLogout">Abmelden</button>

                <div id="addSec" class="card hidden">
                    <h3 id="tBring">Was bringst du mit?</h3>
                    <button onclick="addBeer()" class="btn-w" style="font-size:22px;padding:22px" id="tBeer">Bier</button>
                    <button onclick="showOther()" id="tOther">Anderes Getränk</button>
                    <div id="other" class="hidden" style="margin-top:15px">
                        <input type="text" id="oName" placeholder="z.B. Jägermeister, Fernet">
                        <input type="number" id="oQty" value="1" min="1">
                        <button onclick="addO()" class="btn-s" id="tAddO">Hinzufügen</button>
                    </div>
                </div>

                <div id="conSec" class="card hidden">
                    <h3 id="tConsumed">Was hast du getrunken?</h3>
                    <div id="list"></div>
                </div>
            </div>

            <div class="card" style="margin-top:40px">
                <h2 id="tGeneral">JL Party Übersicht</h2>
                <div id="general"></div>
            </div>

            <footer id="footer">Entwickelt von Anthony Oscar Falcones Alcívar</footer>
        </div>
    </div>

    <script>
        const GITHUB_TOKEN = "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";
        const REPO = "anthonyfalcones98-web/Control_Bebidas";
        const BACKUP_PATH = "backups/";

        const tr = {
            es: {
                title: "Junge Leute · Drink Control 2025", login: "Iniciar Sesión", enter: "Entrar", newU: "Nuevo Usuario", reg: "Crear Usuario", create: "Crear", cancel: "Cancelar",
                welcome: "Bienvenido, ", total: "Tu total de bebidas:", add: "+ Agregar", con: "- Consumir", logout: "Cerrar Sesión", bring: "¿Qué traes para la JL?", beer: "Cerveza", other: "Otra bebida", addO: "Agregar",
                consumed: "¿Qué consumiste?", general: "Estado General JL Party", thDrink: "Bebida", thQty: "Cantidad",
                fill: "¡Completa todos los campos!", passNo: "Las contraseñas no coinciden", exists: "Este usuario ya existe", created: "¡Usuario creado con éxito!", noUser: "Usuario no encontrado", wrongPass: "Contraseña incorrecta",
                howBeer: "¿Cuántas cervezas traes?", noDrinks: "Aún no trajiste nada", confirmDel: "¿Seguro que querés ELIMINAR a \"{0}\" y todas sus bebidas?", deleted: "Usuario eliminado",
                footer: "Desarrollado por Anthony Oscar Falcones Alcívar", backupStatus: "Backup automático activado", backupOk: "Backup guardado correctamente", backupFail: "Backup falló (sin internet)"
            },
            en: {
                title: "Junge Leute · Drink Control 2025", login: "Login", enter: "Login", newU: "New User", reg: "Create User", create: "Create", cancel: "Cancel",
                welcome: "Welcome, ", total: "Your total drinks:", add: "+ Add", con: "- Consume", logout: "Logout", bring: "What are you bringing?", beer: "Beer", other: "Other drink", addO: "Add",
                consumed: "What did you drink?", general: "JL Party Status", thDrink: "Drink", thQty: "Quantity",
                fill: "Fill all fields!", passNo: "Passwords don't match", exists: "User already exists", created: "User created successfully!", noUser: "User not found", wrongPass: "Wrong password",
                howBeer: "How many beers are you bringing?", noDrinks: "You haven't brought anything yet", confirmDel: "PERMANENTLY DELETE \"{0}\" and all drinks?", deleted: "User deleted",
                footer: "Developed by Anthony Oscar Falcones Alcívar", backupStatus: "Auto backup enabled", backupOk: "Backup saved successfully", backupFail: "Backup failed (no internet)"
            },
            de: {
                title: "Junge Leute · Drink Control 2025", login: "Anmelden", enter: "Anmelden", newU: "Neuer Benutzer", reg: "Benutzer erstellen", create: "Erstellen", cancel: "Abbrechen",
                welcome: "Willkommen, ", total: "Deine Getränke gesamt:", add: "+ Hinzufügen", con: "- Verbraucht", logout: "Abmelden", bring: "Was bringst du mit?", beer: "Bier", other: "Anderes Getränk", addO: "Hinzufügen",
                consumed: "Was hast du getrunken?", general: "JL Party Übersicht", thDrink: "Getränk", thQty: "Menge",
                fill: "Bitte alle Felder ausfüllen!", passNo: "Passwörter stimmen nicht überein", exists: "Dieser Benutzer existiert bereits", created: "Benutzer erfolgreich erstellt!", noUser: "Benutzer nicht gefunden", wrongPass: "Falsches Passwort",
                howBeer: "Wie viele Biere bringst du?", noDrinks: "Du hast noch nichts mitgebracht", confirmDel: "\"{0}\" und alle Getränke endgültig LÖSCHEN?", deleted: "Benutzer gelöscht",
                footer: "Entwickelt von Anthony Oscar Falcones Alcívar", backupStatus: "Backup automatisch aktiviert", backupOk: "Backup erfolgreich gespeichert", backupFail: "Backup fehlgeschlagen (keine Internetverbindung?)"
            }
        };

        let lang = 'de';
        let users = JSON.parse(localStorage.getItem('jl_bebidas')) || {};
        let cur = null;
        let admin = false;
        const ADMIN_KEY = 'anthony';
        const ADMIN_PASS = '.Asking882465';
        const GITHUB_TOKEN = "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";
        const REPO = "anthonyfalcones98-web/Control_Bebidas";
        const BACKUP_PATH = "backups/";

        if (!users[ADMIN_KEY]) {
            users[ADMIN_KEY] = {name:'Anthony',pass:ADMIN_PASS,drinks:{},isAdmin:true};
            localStorage.setItem('jl_bebidas', JSON.stringify(users));
        }

        async function backupToGitHub() {
            const date = new Date().toISOString().slice(0,19).replace(/:/g,"-");
            const filename = `backup-jl-party-${date}.json`;
            const content = btoa(unescape(encodeURIComponent(JSON.stringify(users, null, 2))));

            try {
                await fetch(`https://api.github.com/repos/${REPO}/contents/${BACKUP_PATH}${filename}`, {
                    method: "PUT",
                    headers: { "Authorization": `token ${GITHUB_TOKEN}`, "Content-Type": "application/json" },
                    body: JSON.stringify({ message: `Backup ${date}`, content: content, branch: "main" })
                });
                document.getElementById('backupStatus').innerHTML = `✅ Backup saved: ${filename}`;
                document.getElementById('backupStatus').style.color = "#00ff88";
            } catch(e) {
                document.getElementById('backupStatus').innerHTML = `❌ Backup failed (no internet)`;
                document.getElementById('backupStatus').style.color = "#ff2d55";
            }
        }

        function save() {
            localStorage.setItem('jl_bebidas', JSON.stringify(users));
            count(); conList(); genList();
            backupToGitHub();
        }

        function t(k, p=null) {
            let text = tr[lang][k] || tr.de[k] || k;
            return p ? text.replace('{0}', p) : text;
        }

        function changeLang() {
            lang = document.getElementById('langSelect').value;
            upd();
        }

        function upd() {
            document.getElementById('langSelect').value = lang;
            document.getElementById('tLogin').textContent = t('login');
            document.getElementById('tEnter').textContent = t('enter');
            document.getElementById('tNew').textContent = t('newU');
            document.getElementById('tReg').textContent = t('reg');
            document.getElementById('tCreate').textContent = t('create');
            document.getElementById('tCancel').textContent = t('cancel');
            document.getElementById('tWelcome').innerHTML = t('welcome') + '<span id="name"></span><span id="adminBadge" class="admin-badge hidden">ADMIN</span>';
            document.getElementById('tTotal').textContent = t('total');
            document.getElementById('tAdd').textContent = t('add');
            document.getElementById('tCon').textContent = t('con');
            document.getElementById('tLogout').textContent = t('logout');
            document.getElementById('tBring').textContent = t('bring');
            document.getElementById('tBeer').textContent = t('beer');
            document.getElementById('tOther').textContent = t('other');
            document.getElementById('tAddO').textContent = t('addO');
            document.getElementById('tConsumed').textContent = t('consumed');
            document.getElementById('tGeneral').textContent = t('general');
            document.getElementById('footer').textContent = t('footer');
            document.getElementById('backupStatus').textContent = t('backupStatus');
            if (cur) { document.getElementById('name').textContent = users[cur].name; document.getElementById('adminBadge').classList.toggle('hidden', !admin); }
            genList(); conList();
        }

        window.login = function() {
            const u = document.getElementById('userLogin').value.trim();
            const p = document.getElementById('passLogin').value;
            if (!u || !p) return alert(t('fill'));
            const k = u.toLowerCase();
            if (!users[k]) return alert(t('noUser'));
            if (users[k].pass !== p) return alert(t('wrongPass'));
            cur = k; admin = (k === ADMIN_KEY);
            document.getElementById('name').textContent = users[k].name;
            document.getElementById('adminBadge').classList.toggle('hidden', !admin);
            document.getElementById('login').classList.add('hidden');
            document.getElementById('panel').classList.remove('hidden');
            upd(); count(); conList();
        };

        window.showReg = () => { document.getElementById('login').classList.add('hidden'); document.getElementById('register').classList.remove('hidden'); upd(); };
        window.back = () => { document.getElementById('register').classList.add('hidden'); document.getElementById('login').classList.remove('hidden'); upd(); };
        window.reg = function() {
            const u = document.getElementById('newUser').value.trim();
            const p1 = document.getElementById('p1').value, p2 = document.getElementById('p2').value;
            if (!u || !p1 || p1 !== p2) return alert(t('passNo'));
            const k = u.toLowerCase();
            if (users[k]) return alert(t('exists'));
            users[k] = { name: u, pass: p1, drinks: {}, isAdmin: false };
            save();
            alert(t('created')); back();
        };

        window.addMode = () => { document.getElementById('addSec').classList.remove('hidden'); document.getElementById('conSec').classList.add('hidden'); };
        window.conMode = () => { document.getElementById('conSec').classList.remove('hidden'); document.getElementById('addSec').classList.add('hidden'); conList(); };
        window.showOther = () => document.getElementById('other').classList.remove('hidden');
        window.addO = function() {
            const n = document.getElementById('oName').value.trim().toLowerCase();
            const q = +document.getElementById('oQty').value;
            if (n && q > 0) { add(n, q); document.getElementById('oName').value = ''; document.getElementById('other').classList.add('hidden'); }
        };
        window.addBeer = () => { const q = prompt(t('howBeer'), '6'); if (q && q > 0) add('bier', +q); };
        function add(t, q) { if (!users[cur].drinks[t]) users[cur].drinks[t] = 0; users[cur].drinks[t] += q; save(); }
        function count() { document.getElementById('contador').textContent = Object.values(users[cur].drinks).reduce((a, b) => a + b, 0); }
        function conList() {
            const d = document.getElementById('list'); d.innerHTML = '';
            if (Object.keys(users[cur].drinks).length === 0) { d.innerHTML = `<p>${t('noDrinks')}</p>`; return; }
            for (const [type, qty] of Object.entries(users[cur].drinks)) {
                if (qty <= 0) continue;
                const pretty = type.charAt(0).toUpperCase() + type.slice(1);
                d.innerHTML += `<div class="drink"><div><strong>${pretty}</strong>: ${qty}</div><div><input type="number" id="q${type}" min="1" max="${qty}" value="1" style="width:80px"><button class="btn-d" onclick="con('${type}')">OK</button></div></div>`;
            }
        }
        window.con = function(t) {
            const q = +document.getElementById('q' + t).value;
            if (q > 0 && users[cur].drinks[t] >= q) {
                users[cur].drinks[t] -= q;
                if (users[cur].drinks[t] <= 0) delete users[cur].drinks[t];
                save();
            }
        };
        window.logout = () => { if (confirm('Abmelden?')) { cur = null; admin = false; document.getElementById('panel').classList.add('hidden'); document.getElementById('login').classList.remove('hidden'); document.getElementById('addSec').classList.add('hidden'); document.getElementById('conSec').classList.add('hidden'); upd(); } };
        window.delUser = function(k) { if (!admin || k === ADMIN_KEY) return; if (confirm(t('confirmDel', users[k].name))) { delete users[k]; save(); alert(t('deleted')); } };
        function genList() {
            const d = document.getElementById('general'); d.innerHTML = '';
            for (const k in users) {
                const u = users[k], tot = Object.values(u.drinks).reduce((a, b) => a + b, 0);
                let html = `<div class="card"><div style="font-size:22px;font-weight:bold;color:#ff9500">${u.name} ${k === ADMIN_KEY ? '(ADMIN)' : ''}: ${tot}</div>`;
                if (admin && k !== ADMIN_KEY) html += ` <button class="btn-del" onclick="delUser('${k}')">Löschen</button>`;
                html += `<table><tr><th>${t('thDrink')}</th><th>${t('thQty')}</th></tr>`;
                for (const [b, c] of Object.entries(u.drinks)) {
                    const p = b.charAt(0).toUpperCase() + b.slice(1);
                    html += `<tr><td>${p}</td><td>${c}</td></tr>`;
                }
                html += '</table></div>';
                d.innerHTML += html;
            }
        }

        upd(); genList();
    </script>
</body>
</html>

